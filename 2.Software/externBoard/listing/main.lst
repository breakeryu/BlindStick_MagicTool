C51 COMPILER V9.01   MAIN                                                                  04/16/2023 08:47:50 PAGE 1   


C51 COMPILER V9.01, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\output\main.obj
COMPILER INVOKED BY: E:\Keil_v4\C51\BIN\C51.EXE App\main.c BROWSE INCDIR(.\App;.\Mid_Driver;.\Mid_Driver\inc) DEBUG OBJE
                    -CTEXTEND PRINT(.\listing\main.lst) OBJECT(.\output\main.obj)

line level    source

   1          /*****************************************************************************/
   2          /** 
   3           * \file        m_tim.c
   4           * \author      Xiaoyu Ren
   5           * \brief       example for tim 
   6           * \note        
   7           * \version     v0.1
   8           * \ingroup     example
   9          ******************************************************************************/
  10          
  11          #include "hml.h"
  12          
  13          
  14          
  15          void sys_init(void)
  16          {
  17   1          TIM_configTypeDef tc;
  18   1      
  19   1          //enable XFR register
  20   1          SFRX_ON();
  21   1          
  22   1          RCC_configSysClock(); //IRC value = 30MHz
  23   1      
  24   1          GPIO_configMode(PERIPH_GPIO_4, PERIPH_GPIO_PIN_5, PERIPH_GPIO_PIN_MODE_GENERAL_IN_OUT);
  25   1          
  26   1          
  27   1      
  28   1          tc.Frequency_1T_State = DISABLE;
  29   1          tc.function = TIM_function_tim;
  30   1          tc.interruptState = ENABLE;
  31   1          tc.interruptPriority = UTIL_interruptPriority_0;
  32   1          tc.mode = TIM_mode_1;
  33   1          tc.value = TIM_calculateValue(&tc,5000); //5ms的定时周期
  34   1      
  35   1          TIM_config(PERIPH_TIM_0,&tc);
  36   1          TIM_cmd(PERIPH_TIM_0,ENABLE);
  37   1      
  38   1          enableAllInterrupts();
  39   1      
  40   1          
  41   1          //disable XFR register
  42   1          SFRX_OFF();
  43   1      }
  44          
  45          
  46          void main(void)
  47          {
  48   1      
  49   1          sys_init();
  50   1      
  51   1          while (1)
  52   1          {
  53   2              
  54   2          }
C51 COMPILER V9.01   MAIN                                                                  04/16/2023 08:47:50 PAGE 2   

  55   1          
  56   1      
  57   1      }
  58          
  59          /*****************************************************************************/
  60          /** 
  61           * \author      Jiabin Hsu
  62           * \author      Xiaoyu Ren
  63           * \date        
  64           * \brief       interrupt service function for TIM0
  65           * \param[in]   
  66           * \return      none
  67           * \ingroup     example
  68           * \remarks     
  69          ******************************************************************************/
  70          INTERRUPT(Timer0_Routine,EXTI_VectTimer0)
  71          {
  72   1          static uint8_t i = 0;
  73   1      
  74   1          /* per 500ms */
  75   1          i++;
  76   1          if (i == 10)
  77   1          {
  78   2              GPIO_toggleBitValue(PERIPH_GPIO_4, PERIPH_GPIO_PIN_5);
  79   2              i = 0;
  80   2          }
  81   1      }
  82          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    147    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      1       7
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
